<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Tic Tac Toe</title>
<style>
  /* Reset and body */
  body {
    margin: 0;
    font-family: Arial, sans-serif;
    text-align: center;
    user-select: none;
    background: white;
    transition: background 0.5s;
    color: black;
  }
  
  /* Heading */
  h1 {
    margin: 20px 0;
    color: black;
  }
  
  /* Board grid */
  #board {
    display: grid;
    grid-template-columns: repeat(3, 100px);
    gap: 5px;
    justify-content: center;
    margin-top: 20px;
  }
  
  /* Cells */
  .cell {
    width: 100px;
    height: 100px;
    background: #ccc; /* grey cells */
    font-size: 40px;
    font-weight: bold;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    transition: background 0.3s;
  }
  .cell.X:hover { background: #a3c4ff; }
  .cell.O:hover { background: #ff8a8a; }
  .cell.X { color: blue; }
  .cell.O { color: red; }
  
  /* Status */
  #status {
    font-size: 20px;
    margin: 10px 0;
  }
  
  /* Buttons general */
  button {
    padding: 10px 20px;
    margin: 5px;
    border: none;
    font-size: 14px;
    font-weight: bold;
    border-radius: 6px;
    cursor: pointer;
    transition: transform 0.1s, background 0.3s, box-shadow 0.3s;
  }
  button:active { transform: scale(0.95); }
  
  /* Start / Who starts / Restart */
  #startGame { background: #1e90ff; color: white; }
  #whoStarts { background: gray; color: white; }
  #restart { background: #1f8b1f; color: white; margin-top: 15px; }
  
  /* Difficulty buttons */
  #difficulty { margin-top: 15px; }
  #difficulty button {
    background: white; color: black;
    padding: 8px 15px; margin: 5px;
    border-radius: 6px; font-weight: bold;
    cursor: pointer; transition: all 0.3s;
  }
  #difficulty button.friend:hover,
  #difficulty button.friend.active { background: gray; color: white; box-shadow: 0 0 5px gray; }
  #difficulty button.simple:hover,
  #difficulty button.simple.active { background: #3498db; color: white; box-shadow: 0 0 5px #3498db; }
  #difficulty button.easy:hover,
  #difficulty button.easy.active { background: #2ecc71; color: white; box-shadow: 0 0 5px #2ecc71; }
  #difficulty button.medium:hover,
  #difficulty button.medium.active { background: #e67e22; color: white; box-shadow: 0 0 5px #e67e22; }
  #difficulty button.hard:hover,
  #difficulty button.hard.active { background: #e74c3c; color: white; box-shadow: 0 0 15px #e74c3c; }
  #difficulty button.impossible:hover,
  #difficulty button.impossible.active { background: #4B0082; color: white; box-shadow: 0 0 15px #4B0082; }
  
  /* Flash animation for Who Starts */
  @keyframes flashRedBlue {
    0% { box-shadow: 0 0 10px red; }
    50% { box-shadow: 0 0 10px blue; }
    100% { box-shadow: none; }
  }
  
  /* Mobile Responsive */
  @media (max-width: 500px) {
    #board {
      grid-template-columns: repeat(3, 90px);
      gap: 6px;
      margin-top: 20px;
    }
    .cell {
      width: 90px;
      height: 90px;
      font-size: 36px;
    }
    button {
      padding: 12px 20px;
      font-size: 14px;
      margin: 6px;
    }
    #startGame, #whoStarts, #restart {
      width: 80%;
      max-width: 250px;
    }
  }

</style>
</head>
<body>
<h1>Tic Tac Toe</h1>

<div id="difficulty">
  <button class="friend">Friend</button>
  <button class="simple">Simple</button>
  <button class="easy">Easy</button>
  <button class="medium">Medium</button>
  <button class="hard">Hard</button>
  <button class="impossible">Impossible</button>
</div>

<div>
  <button id="startGame">Start</button>
  <button id="whoStarts">Who Start's?</button>
</div>

<div id="board"></div>
<div>
  <button id="restart">Restart</button>
</div>
<div id="status"></div>

<script>
const boardEl = document.getElementById("board");
const startBtn = document.getElementById("startGame");
const whoStartsBtn = document.getElementById("whoStarts");
const restartBtn = document.getElementById("restart");
const diffBtns = document.querySelectorAll("#difficulty button");
const statusEl = document.getElementById("status");

let cells = Array(9).fill("");
let currentPlayer = null;
let startingPlayer = null;
let gameActive = false;
let difficulty = "friend";

// Board creation
for (let i = 0; i < 9; i++) {
  const cell = document.createElement("div");
  cell.classList.add("cell");
  cell.addEventListener("click", () => playerMove(i));
  boardEl.appendChild(cell);
}

// Difficulty buttons
diffBtns.forEach(btn => {
  btn.addEventListener("click", () => {
    diffBtns.forEach(b => b.classList.remove("active"));
    btn.classList.add("active");
    difficulty = btn.classList[0];
    restartGame(false);
  });
});

// Who starts toggle
whoStartsBtn.addEventListener("click", () => {
  if (startingPlayer === "X") {
    startingPlayer = "O";
    whoStartsBtn.textContent = "O Start's The Game";
    whoStartsBtn.style.background = "red";
  } else {
    startingPlayer = "X";
    whoStartsBtn.textContent = "X Start's The Game";
    whoStartsBtn.style.background = "blue";
  }
});

// Start button
startBtn.addEventListener("click", () => {
  if (!startingPlayer) {
    whoStartsBtn.style.animation = "flashRedBlue 0.4s";
    setTimeout(() => whoStartsBtn.style.animation = "", 400);
    return;
  }
  gameActive = true;
  currentPlayer = startingPlayer;
  if (startingPlayer === "O" && difficulty !== "friend") setTimeout(aiMove, 1000);
});

// Change body to random color
function changeBackground() {
  const r = Math.floor(Math.random()*256);
  const g = Math.floor(Math.random()*256);
  const b = Math.floor(Math.random()*256);
  document.body.style.background = `rgb(${r},${g},${b})`;
}

// Player move
function playerMove(i) {
  if (!gameActive || cells[i] !== "") return;
  cells[i] = currentPlayer;
  boardEl.children[i].textContent = currentPlayer;
  boardEl.children[i].classList.add(currentPlayer);

  changeBackground();

  if (checkEnd()) return;

  currentPlayer = (currentPlayer === "X") ? "O" : "X";
  if (difficulty !== "friend" && currentPlayer === "O") setTimeout(aiMove, 1000);
}

// AI move
function aiMove() {
  if (!gameActive) return;
  let empty = cells.map((v,i)=>v===""?i:null).filter(v=>v!==null);
  if (empty.length === 0) return;
  let move = empty[Math.floor(Math.random()*empty.length)];
  cells[move] = "O";
  boardEl.children[move].textContent = "O";
  boardEl.children[move].classList.add("O");

  changeBackground();
  if (!checkEnd()) currentPlayer = "X";
}

// Check win/draw
function checkEnd() {
  const wins = [
    [0,1,2],[3,4,5],[6,7,8],
    [0,3,6],[1,4,7],[2,5,8],
    [0,4,8],[2,4,6]
  ];
  if (wins.some(line => line.every(i => cells[i] === currentPlayer))) {
    statusEl.textContent = `${currentPlayer} Wins!`;
    gameActive = false;
    return true;
  }
  if (!cells.includes("")) {
    statusEl.textContent = "Draw!";
    gameActive = false;
    return true;
  }
  return false;
}

// Restart
restartBtn.addEventListener("click", () => restartGame(true));

function restartGame(resetColor) {
  cells.fill("");
  for (let i=0;i<9;i++) {
    boardEl.children[i].textContent = "";
    boardEl.children[i].className = "cell";
  }
  statusEl.textContent = "";
  gameActive = false;
  currentPlayer = null;
  if (resetColor) document.body.style.background = "white";
}

document.querySelector("#difficulty .friend").classList.add("active");
</script>
</body>
</html>
